<ion-header>
  <ion-toolbar>
    <ion-title>Teacher Home</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Selección de curso -->
  <ion-item>
    <ion-label>Selecciona un curso</ion-label>
    <ion-select [(ngModel)]="selectedCourseId" (ionChange)="onCourseChange(selectedCourseId)">
      <ion-select-option *ngFor="let course of courses" [value]="course.id">{{ course.name }}</ion-select-option>
    </ion-select>
  </ion-item>

  <!-- Selección de sección, solo visible si hay un curso seleccionado -->
  <ion-item *ngIf="selectedCourseId">
    <ion-label>Selecciona una sección</ion-label>
    <ion-select [(ngModel)]="selectedSection">
      <ion-select-option *ngFor="let section of (courses | findCourse:selectedCourseId)?.sections" [value]="section">
        {{ section }}
      </ion-select-option>
    </ion-select>
  </ion-item>

  <!-- Botón para generar el código QR, solo habilitado si curso y sección están seleccionados -->
  <ion-button (click)="generateQRCode()" [disabled]="!selectedCourseId || !selectedSection">
    Generar Código QR
  </ion-button>

  <!-- Botón para cargar asistencia -->
  <ion-button (click)="loadAttendance()" [disabled]="!selectedCourseId || !selectedSection">
    Cargar Asistencia
  </ion-button>

  <!-- Muestra el código QR generado -->
  <div *ngIf="qrCodeUrl">
    <img [src]="qrCodeUrl" alt="Código QR">
  </div>

  <!-- Lista de registros de asistencia -->
  <ion-list>
    <ion-item *ngFor="let record of attendanceRecords">
      <ion-label>
        <h2>{{ record.date }}</h2>
        <p>Curso: {{ record.courseId }}</p>
        <p>Sección: {{ record.section }}</p>
        <p>Nombre Estudiante: {{ record.studentName }}</p>
        <p>ID Estudiante: {{ record.studentId }}</p>
        <p>Hora: {{ record.time }}</p>
      </ion-label>
    </ion-item>
  </ion-list>
</ion-content>
